"use strict";

var _express = _interopRequireDefault(require("express"));

var _discord = _interopRequireDefault(require("discord.js"));

var _prefix = _interopRequireDefault(require("../prefix.json"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

// Generated by CoffeeScript 2.5.1
var app, client;
client = new _discord["default"].Client();
app = _express["default"];
app.listen(process.env.PORT);
client.on('ready', function () {
  return console.log("Logged in as ".concat(client.user.tag, "!"));
});
client.on('message', function (msg) {
  var args, command, commandFile, err;

  if (!msg.content.toLowerCase().startsWith(_prefix["default"].prefix)) {
    return;
  }

  if (msg.content.toLowerCase().match(/\n/g)) {
    msg.channel.send('O Kirigiri-chan ainda não possui suporte a múltiplos comandos');
  }

  args = msg.content.trim().slice(_prefix["default"].prefix.length).split(/ +/g);
  command = args.shift().toLowerCase();

  try {
    commandFile = require("./commands/".concat(command, ".coffee"));
    return commandFile.run(client, msg, args);
  } catch (error) {
    err = error;
    return console.log(err);
  }
});
client.login(process.env['TOKEN']);